# Rust语言操作系统的设计与实现 reading

> 好厉害

## rust语言特性

- 所有权和借用机制；
- 两个标记特性（marker trait）： Send 和 Sync
- 面向协议（prototypebased）的派别，即关注类的公共行为而不是它们的继承关系。
- 部分函数式编程特性；
- 应尽量避免 unsafe 代码，并将其封装成安全的接口。
- 一个核心库 core，仅包含和语言特性紧密相关的实现，可用于编写裸机程序。

## Rust 语言操作系统 rCore 的设计与实现

- rCore 直接基于 BlogOS 第一版第 10章的代码完成后续工作。

层次：

- 系统的最底层，对于不同的指令集， rCore 总结出一套最小化的平台相关
接口。
- 在内核平台无关层， rCore 增加了网络协议栈并将之封装成 Socket 接口，与虚拟文件系统的 INode 接口一起，封装成文件提供给用户程序。
- 在系统调用层面， rCore 主要针对 Linux 的 musl libc① 实现了它所用到的接口。

低耦合的项目结构：

- 大量使用外部软件包
- 最小化平台相关代码
- 子系统模块化

> 对于需要实现的新功能，我们遵循”quick and dirty” 的原则，采用最快最简单的方案去实现。一切以尽早让程序正常运行为奋斗目标。

（感觉接下来的部分需要对应源代码仔细观察；不过在这之前需要对rust有一个比较深入的了解。）

## 操作系统设计实现经验谈

- 迭代式开发：每次先定下一个小目标，然后依次进行方案设计、代码实现、测试和重构。
- 例如每个函数签名处必须有描述文档，尚未实现的特性必须写 TODO 或 FIXME，可能出问题的地方也必须用 WARNING 提示出来。
- 测试驱动开发
- 遵守行业标准
- 面向接口编程
- 持续推进重构

>没有人能一开始就设计出最合理的软件架构，架构是根据需求的推动而自然演化的。这样看来， rCore 就像是一个有机生命体，开发者们持续的维护是它活力的根源。

## Rust 编写操作系统的能力分析

- 虽然一般的 Rust 代码对应的底层实现是不可控的，但如有需要一切都可以精确控制。因此我们认为 Rust 具有和 C 语言等价的底层控制能力。
- 强大的抽象与优化能力；强大到激进的优化策略也会带来一些问题。

>为了保证内存安全， Rust 提供了很强大的工具，但使用这些工具的门槛过高。

# 尝试用RUST写教学操作系统

- RUST对Linux安全漏洞的安全性增强